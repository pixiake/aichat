(()=>{var a={n:r=>{var t=r&&r.__esModule?()=>r.default:()=>r;return a.d(t,{a:t}),t},d:(r,t)=>{for(var e in t)a.o(t,e)&&!a.o(r,e)&&Object.defineProperty(r,e,{enumerable:!0,get:t[e]})},o:(a,r)=>Object.prototype.hasOwnProperty.call(a,r)};(()=>{"use strict";const r=flarum.core.compat["common/app"];a.n(r)().initializers.add("pixiake/aichat",(function(){console.log("Hello, forum and admin!")}));const t=flarum.core.compat["forum/app"];var e=a.n(t);const o=flarum.core.compat["common/extend"],s=flarum.core.compat["forum/components/CommentPost"];var i=a.n(s);const n=flarum.core.compat["common/components/Button"];var c=a.n(n);e().initializers.add("pixiake/aichat",(function(){(0,o.extend)(i().prototype,"headerItems",(function(a){var r=this.attrs.post,t=r.attribute("isMarkedCorrect"),e=r.attribute("isMarkedWrong");(t||e)&&a.add("answerMark",m("div",{className:"AnswerMark "+(t?"correct":"wrong")},m("i",{className:t?"fas fa-check":"fas fa-times"}),m("span",null,t?app.translator.trans("pixiake-aichat.forum.correct_answer"):app.translator.trans("pixiake-aichat.forum.wrong_answer"))),100)})),(0,o.extend)(i().prototype,"actionItems",(function(a){var r=this.attrs.post,t=r.attribute("isMarkedCorrect"),e=r.attribute("isMarkedWrong"),o=app.forum.attribute("botUserId"),s=r.discussion(),i=app.forum.attribute("needLearnTags"),n=app.forum.attribute("learnedTags");r.user()&&r.user().id()===o&&app.session.user&&(app.session.user.isAdmin()||app.session.user.hasPermission("discussion.moderate"))&&(a.add("markCorrect",c().component({className:"Button Button--link "+(t?"marked-correct":""),onclick:function(){r.pushAttributes({isMarkedCorrect:!t,isMarkedWrong:!1}),app.request({method:"POST",url:app.forum.attribute("apiUrl")+"/ai-chat/v1alpha1/mark-post",body:{postId:r.id(),isCorrect:!t,isWrong:!1}}).catch((function(a){app.alerts.show({type:"error"},a.message)})),app.request({method:"POST",url:app.forum.attribute("apiUrl")+"/ai-chat/v1alpha1/mark-discussion",body:{discussionId:s.id(),mark:{learned:{ids:n,action:t?"":"add"},needToLearn:{ids:i,action:t?"":"remove"}}}}).catch((function(a){app.alerts.show({type:"error"},a.message)}))},icon:t?"fas fa-check-circle":"far fa-check-circle"},t?app.translator.trans("pixiake-aichat.forum.unmark_correct"):app.translator.trans("pixiake-aichat.forum.mark_correct")),-10),a.add("markWrong",c().component({className:"Button Button--link "+(e?"marked-wrong":""),onclick:function(){r.pushAttributes({isMarkedCorrect:!1,isMarkedWrong:!e}),app.request({method:"POST",url:app.forum.attribute("apiUrl")+"/ai-chat/v1alpha1/mark-post",body:{postId:r.id(),isCorrect:!1,isWrong:!e}}).catch((function(a){app.alerts.show({type:"error"},a.message)})),app.request({method:"POST",url:app.forum.attribute("apiUrl")+"/ai-chat/v1alpha1/mark-discussion",body:{discussionId:s.id(),mark:{needToLearn:{ids:i,action:e?"":"add"},learned:{ids:n,action:e?"":"remove"}}}}).catch((function(a){app.alerts.show({type:"error"},a.message)}))},icon:e?"fas fa-times-circle":"far fa-times-circle"},e?app.translator.trans("pixiake-aichat.forum.unmark_wrong"):app.translator.trans("pixiake-aichat.forum.mark_wrong")),-9))}))}))})(),module.exports={}})();
//# sourceMappingURL=forum.js.map